@{
    ViewData["Title"] = "İdarəetmə paneli";
}

<style>
    .select2-container {
        width: 200px !important;
    }

    .dash-card {
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 16px;
        transition: box-shadow 0.2s;
    }

        .dash-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }

        .dash-card .icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            flex-shrink: 0;
        }

        .dash-card .info .value {
            font-size: 1.6rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .dash-card .info .label {
            font-size: 0.8rem;
            color: #6c757d;
        }

    .chart-box {
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        padding: 16px;
        display: flex;
        flex-direction: column;
    }

        .chart-box .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

            .chart-box .chart-header h6 {
                font-size: 0.85rem;
                font-weight: 600;
                color: #333;
                margin: 0;
            }

            .chart-box .chart-header .chart-actions {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .chart-box .chart-header .download-btn {
                background: none;
                border: 1px solid #dee2e6;
                border-radius: 4px;
                width: 28px;
                height: 28px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                font-size: 14px;
                color: #6c757d;
                transition: all 0.15s;
                flex-shrink: 0;
            }

                .chart-box .chart-header .download-btn:hover {
                    background: #f8f9fa;
                    color: #333;
                    border-color: #adb5bd;
                }

        .chart-box canvas {
            flex: 1;
            min-height: 0;
        }

    .dash-filter {
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        padding: 10px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 0.85rem;
    }

        .dash-filter label {
            margin: 0;
            font-weight: 500;
            white-space: nowrap;
        }

        .dash-filter input {
            height: 32px;
            font-size: 0.8rem;
            max-width: 220px;
        }

        .dash-filter .btn {
            height: 32px;
            font-size: 0.8rem;
            padding: 4px 14px;
        }
</style>

<div class="d-flex flex-column gap-3">

    <div class="dash-filter">
        <label>DTTBİ-ə daxil olma tarix aralığı:</label>
        <input id="dashDateRange" class="form-control" placeholder="Hamısı" autocomplete="off" />
        <button id="dashApply" class="btn btn-primary btn-sm">Tətbiq et</button>
        <button id="dashReset" class="btn btn-outline-secondary btn-sm">Sıfırla</button>
    </div>

    <div class="row g-3" id="statCards">
        <div class="col-3">
            <div class="dash-card">
                <div class="icon" style="background:#e8f5e9;color:#2e7d32;">📋</div>
                <div class="info">
                    <div class="value" id="statTotal">-</div>
                    <div class="label">Ümumi məlumat</div>
                </div>
            </div>
        </div>
        <div class="col-3">
            <div class="dash-card">
                <div class="icon" style="background:#fce4ec;color:#c62828;">🔒</div>
                <div class="info">
                    <div class="value" id="statTopSecret">-</div>
                    <div class="label">Tam məxfi</div>
                </div>
            </div>
        </div>
        <div class="col-3">
            <div class="dash-card">
                <div class="icon" style="background:#fff3e0;color:#e65100;">🔐</div>
                <div class="info">
                    <div class="value" id="statSecret">-</div>
                    <div class="label">Məxfi</div>
                </div>
            </div>
        </div>
        <div class="col-3">
            <div class="dash-card">
                <div class="icon" style="background:#e3f2fd;color:#1565c0;">📅</div>
                <div class="info">
                    <div class="value" id="statThisMonth">-</div>
                    <div class="label">Bu ay</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-6">
            <div class="chart-box" style="height: 380px;">
                <div class="chart-header">
                    <h6>Hərbi hissələr üzrə</h6>
                    <button class="download-btn" data-canvas="chartByBase" title="PNG yüklə">⬇</button>
                </div>
                <canvas id="chartByBase"></canvas>
            </div>
        </div>
        <div class="col-6">
            <div class="chart-box" style="height: 380px;">
                <div class="chart-header">
                    <h6>Aylıq dinamika</h6>
                    <button class="download-btn" data-canvas="chartTrend" title="PNG yüklə">⬇</button>
                </div>
                <canvas id="chartTrend"></canvas>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-6">
            <div class="chart-box" style="height: 340px;">
                <div class="chart-header">
                    <h6>Rütbələr üzrə</h6>
                    <button class="download-btn" data-canvas="chartByRank" title="PNG yüklə">⬇</button>
                </div>
                <canvas id="chartByRank"></canvas>
            </div>
        </div>
        <div class="col-6">
            <div class="chart-box" style="height: 340px;">
                <div class="chart-header">
                    <h6>İcraçılar üzrə</h6>
                    <button class="download-btn" data-canvas="chartByExecutor" title="PNG yüklə">⬇</button>
                </div>
                <canvas id="chartByExecutor"></canvas>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-4">
            <div class="chart-box" style="height: 320px;">
                <div class="chart-header">
                    <h6>Buraxılış forması</h6>
                    <button class="download-btn" data-canvas="chartPrivacy" title="PNG yüklə">⬇</button>
                </div>
                <canvas id="chartPrivacy"></canvas>
            </div>
        </div>
        <div class="col-8">
            <div class="chart-box" style="height: 320px;">
                <div class="chart-header">
                    <h6>İcra vəziyyəti</h6>
                    <button class="download-btn" data-canvas="chartStatus" title="PNG yüklə">⬇</button>
                </div>
                <canvas id="chartStatus"></canvas>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-6">
            <div class="chart-box" style="height: 380px;">
                <div class="chart-header">
                    <h6>Hərbi hissə üzrə təfsilat</h6>
                    <div class="chart-actions">
                        <select id="baseFilterSelect"
                                class="form-select form-select-sm"
                                asp-items="ViewBag.MilitaryBases">
                            <option value="">Hərbi hissə seçin...</option>
                        </select>
                        <button class="download-btn" data-canvas="chartBaseDetail" title="PNG yüklə">⬇</button>
                    </div>
                </div>
                <canvas id="chartBaseDetail"></canvas>
            </div>
        </div>
        <div class="col-6">
            <div class="chart-box" style="height: 380px;">
                <div class="chart-header">
                    <h6>Rütbə üzrə təfsilat</h6>
                    <div class="chart-actions">
                        <select id="rankFilterSelect"
                                class="form-select form-select-sm"
                                asp-items="ViewBag.MilitaryRanks">
                            <option value="">Rütbə seçin...</option>
                        </select>
                        <button class="download-btn" data-canvas="chartRankDetail" title="PNG yüklə">⬇</button>
                    </div>
                </div>
                <canvas id="chartRankDetail"></canvas>
            </div>
        </div>
    </div>

</div>

<script src="~/lib/chartjs/chart.umd.min.js"></script>
<script src="~/lib/chartjs/chartjs-plugin-datalabels@2.js"></script>

@section Scripts {
    <script src="~/js/dashboard.js" asp-append-version="true"></script>
}
